<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="FlyingLandlord's Blog" href="http://flyinglandlord.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="FlyingLandlord's Blog" href="http://flyinglandlord.github.io/atom.xml"><link rel="alternate" type="application/json" title="FlyingLandlord's Blog" href="http://flyinglandlord.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="北航计算机组成原理,Verilog,MIPS,流水线CPU,P7课上,P7课下"><link rel="canonical" href="http://flyinglandlord.github.io/2021/12/15/BUAA-CO-2021/P7/P7%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/"><title>P7 课下 & 课上总结 - 北航计算机组成原理 | Test Blog = FlyingLandlord's Blog</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">P7 课下 & 课上总结</h1><div class="meta"><span class="item" title="创建时间：2021-12-15 22:45:45"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-12-15T22:45:45+08:00">2021-12-15</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Test Blog</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://api.yimian.xyz/img?type=wallpaper&size=1920x1080?577109"></li><li class="item" data-background-image="https://api.yimian.xyz/img?type=wallpaper&size=1920x1080?539547"></li><li class="item" data-background-image="https://api.yimian.xyz/img?type=wallpaper&size=1920x1080?990763"></li><li class="item" data-background-image="https://api.yimian.xyz/img?type=wallpaper&size=1920x1080?613009"></li><li class="item" data-background-image="https://api.yimian.xyz/img?type=wallpaper&size=1920x1080?914842"></li><li class="item" data-background-image="https://api.yimian.xyz/img?type=wallpaper&size=1920x1080?924300"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" itemprop="item" rel="index" title="分类于 北航计算机组成原理"><span itemprop="name">北航计算机组成原理</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://flyinglandlord.github.io/2021/12/15/BUAA-CO-2021/P7/P7%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="FL"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="FlyingLandlord's Blog"></span><div class="body md" itemprop="articleBody"><h1 id="p7mips微系统设计"><a class="anchor" href="#p7mips微系统设计">#</a> P7：MIPS 微系统设计</h1><div class="note warning"><p>通过阅读本文，您可以大致了解 2021 年秋季北航计算机组成课程 P7 课下搭建的思路，以及课上测试的题目内容、难度和解题思路<br>P7 课上测试的主要内容是对课下用 Verilog 搭建的 MIPS 微系统进行强测，同时添加一条新指令<br>题目每年都会发生变化，题意描述可能与原题有一定差异<br>本文的目的在于解释一下本就说的不是很明白的教程，然后谈一谈我的理解，并不一定完全正确，最终还是应当以教程、高老板 PPT 和《See MIPS Run Linux》为准</p></div><p>::: 结束了，不用每周都去课上考试了！:::</p><p></p><div class="media-container"><div class="player" data-type="audio" data-src='[{"title":"Something","list":["https://music.163.com/#/song?id=442562803","https://music.163.com/#/song?id=550128","https://music.163.com/#/song?id=4919981","https://music.163.com/#/song?id=33556365"]}]'></div></div><p></p><h2 id="课下设计概述"><a class="anchor" href="#课下设计概述">#</a> 课下设计概述</h2><p>要求实现的指令集为 <code>MIPS-C4</code> ，即<strong> LB、LBU、LH、LHU、LW、SB、SH、SW、ADD、ADDU、 SUB、SUBU、MULT、MULTU、DIV、DIVU、SLL、SRL、SRA、SLLV、 SRLV、SRAV、AND、OR、XOR、NOR、ADDI、ADDIU、ANDI、ORI、 XORI、LUI、SLT、SLTI、SLTIU、SLTU、BEQ、BNE、BLEZ、BGTZ、 BLTZ、BGEZ、J、JAL、JALR、JR、MFHI、MFLO、MTHI、MTLO、MFC0、MTC0、ERET</strong>，在 P6 的基础上新增加了 MFC0、MTC0、ERET</p><p>整体结构目录树如下：</p><p><img data-src="https://s2.loli.net/2021/12/15/k3ICn6Z5ur1O8l9.png" alt="image-20211213214921556"></p><p>MIPS 微系统整体设计如下图（图片来源：2021 秋季计组教程）</p><p><img data-src="https://s2.loli.net/2021/12/15/dxJgXYyS4wa9KQk.png" alt="image-20211215230155248"></p><p><strong>P7 最难的就是课下，课下完成之后，课上就是三个提交窗口对课下进行强测，加一条指令，四过三即可</strong></p><p><strong>更难的是要读懂教程，因此这篇文章将尝试解读一下教程里面的内容</strong></p><p>P7 主要还是要做三件事：<strong>更改流水线各级使之可以产生异常，添加 CP0 处理异常，添加 Bridge 与两个外设（计时器）交互</strong>，这三件事建议从前往后一件一件的做</p><p>首先对异常和中断的处理有一个整体的理解，可以理解成我们添加了<strong>两种新的跳转指令</strong>，第一种跳转的条件是<strong>指令执行时产生异常</strong>或者<strong>外部、外设发出了中断信号</strong>，跳转的位置是固定的 <code>0x4180</code> ，至于怎么响应中断，怎么处理异常，从 0x4180 开始都是软件写好的，我们无需关心，跳转时要把相应的当前指令地址（<strong>如果是延迟槽的话就是当前指令地址 - 4</strong>）写入 EPC，第二种跳转条件是遇到 <code>eret</code> 指令，我们需要从当前位置跳回 EPC 中的地址，同时 ** <code>eret</code> 后面的指令不能被执行 **</p><p>第一种情况需要更改流水线各级，使之可以产生异常，发生异常之后，我们把异常信号一直传递到 M 级的 CP0，CP0 负责决定是否接受并处理这个异常，如果 CP0 决定处理，这时就需要进行跳转行为</p><p>第二种情况对于 <code>eret</code> 的处理，我们是在 D 级判断，如果出现 <code>eret</code> 指令，就需要置位 F_PC 和 NPC 分别为 EPC 和 EPC+4（<em>想一想为什么要置位 NPC？</em>）</p><p>对于异常的处理，按照教程，我们需要处理的异常包括下面几种</p><table><thead><tr><th style="text-align:left">异常与中断码</th><th style="text-align:left">助记符与名称</th><th style="text-align:left">指令与指令类型</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">0</td><td style="text-align:left"><code>Int</code> (外部中断)</td><td style="text-align:left">所有指令</td><td style="text-align:left">中断请求，来源于计时器与外部中断</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left"><code>AdEL</code> (取指异常)</td><td style="text-align:left">所有指令</td><td style="text-align:left">PC 地址未字对齐</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left"><code>AdEL</code> (取指异常)</td><td style="text-align:left">所有指令</td><td style="text-align:left">PC 地址超过 <code>0x3000 ~ 0x6ffc</code></td></tr><tr><td style="text-align:left">4</td><td style="text-align:left"><code>AdEL</code> (取数异常)</td><td style="text-align:left"><code>lw</code></td><td style="text-align:left">取数地址未与 4 字节对齐</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left"><code>AdEL</code> (取指异常)</td><td style="text-align:left"><code>lh</code> , <code>lhu</code></td><td style="text-align:left">取数地址未与 2 字节对齐</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left"><code>AdEL</code> (取指异常)</td><td style="text-align:left"><code>lh</code> , <code>lhu</code> , <code>lb</code> , <code>lbu</code></td><td style="text-align:left">取 Timer 寄存器的值</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left"><code>AdEL</code> (取指异常)</td><td style="text-align:left">load 型指令</td><td style="text-align:left">计算地址时加法溢出</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left"><code>AdEL</code> (取指异常)</td><td style="text-align:left">load 型指令</td><td style="text-align:left">取数地址超出 DM、Timer0、Timer1 的范围</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left"><code>AdES</code> (存数异常)</td><td style="text-align:left"><code>sw</code></td><td style="text-align:left">存数地址未 4 字节对齐</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left"><code>AdES</code> (存数异常)</td><td style="text-align:left"><code>sh</code></td><td style="text-align:left">存数地址未 2 字节对齐</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left"><code>AdES</code> (存数异常)</td><td style="text-align:left"><code>sh</code> , <code>sb</code></td><td style="text-align:left">存 Timer 寄存器的值</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left"><code>AdES</code> (存数异常)</td><td style="text-align:left">store 型指令</td><td style="text-align:left">计算地址加法溢出</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left"><code>AdES</code> (存数异常)</td><td style="text-align:left">store 型指令</td><td style="text-align:left">存数地址超出 DM、Timer0、Timer1 的范围</td></tr><tr><td style="text-align:left">10</td><td style="text-align:left"><code>RI</code> (未知指令)</td><td style="text-align:left">-</td><td style="text-align:left">未知的指令码</td></tr><tr><td style="text-align:left">12</td><td style="text-align:left"><code>Ov</code> (溢出异常)</td><td style="text-align:left"><code>add</code> , <code>addi</code> , <code>sub</code></td><td style="text-align:left">算术溢出</td></tr></tbody></table><p>则可以发现我们要处理的部分包括 F 级的 IFU 部分，D 级的 Control 译码部分和 E 级的 ALU 部分以及<strong>最难的 M 级的 DM 部分</strong></p><p>直接放出对应的代码块供参考</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// ------ IFU ------</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> tmp_F_PC<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>F_PC <span class="token function">_pc</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">clk</span><span class="token punctuation">(</span>clk<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span>reset<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">Req</span><span class="token punctuation">(</span>Req<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">PC_WrEn</span><span class="token punctuation">(</span>PC_WrEn<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">NPC</span><span class="token punctuation">(</span>NPC<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">.</span><span class="token function">PC</span><span class="token punctuation">(</span>tmp_F_PC<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">assign</span> F_PC <span class="token operator">=</span> D_eret <span class="token operator">?</span> EPC <span class="token punctuation">:</span> tmp_F_PC<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">assign</span> F_EXC_AdEL <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">|</span> F_PC<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>F_PC <span class="token operator">&lt;</span> <span class="token number">32'h0000_3000</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>F_PC <span class="token operator">></span> <span class="token number">32'h0000_6ffc</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>D_eret<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">assign</span> i_inst_addr <span class="token operator">=</span> F_PC<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">assign</span> F_Instr <span class="token operator">=</span> <span class="token punctuation">(</span>F_EXC_AdEL<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">32'd0</span> <span class="token punctuation">:</span> i_inst_rdata<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">// -----------------</span></pre></td></tr></table></figure><p>可以看到关键在于对 F_EXC_AdEL 的赋值，为什么要向 PC 中传入 Req（中断请求）呢？显然是因为上面的第二条，如果出现中断 PC 需要立刻变成 0x4180；此外，按照要求，如果出现异常，向后提交的 Instr 应当是 0，所以会有最后一句</p><p>对于 D 级的不认识的指令异常，我们直接在 Control 里面修改，如果有无法译码的指令，直接连出来一个信号表示异常</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">assign</span> D_EXC_RI <span class="token operator">=</span> <span class="token operator">!</span><span class="token punctuation">(</span>beq <span class="token operator">|</span> bne <span class="token operator">|</span> bgez <span class="token operator">|</span> bgtz <span class="token operator">|</span> blez <span class="token operator">|</span> bltz <span class="token operator">|</span></pre></td></tr><tr><td data-num="2"></td><td><pre>                    j <span class="token operator">|</span> jal <span class="token operator">|</span> jalr <span class="token operator">|</span> jr <span class="token operator">|</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                    lb <span class="token operator">|</span> lbu <span class="token operator">|</span> lh <span class="token operator">|</span> lhu <span class="token operator">|</span> lw <span class="token operator">|</span> sb <span class="token operator">|</span> sh <span class="token operator">|</span> sw <span class="token operator">|</span></pre></td></tr><tr><td data-num="4"></td><td><pre>                    lui <span class="token operator">|</span> addi <span class="token operator">|</span> addiu <span class="token operator">|</span> andi <span class="token operator">|</span> ori <span class="token operator">|</span> xori <span class="token operator">|</span> slti <span class="token operator">|</span> sltiu <span class="token operator">|</span></pre></td></tr><tr><td data-num="5"></td><td><pre>                    add <span class="token operator">|</span> addu <span class="token operator">|</span> sub <span class="token operator">|</span> subu <span class="token operator">|</span> And <span class="token operator">|</span> Nor <span class="token operator">|</span> Or <span class="token operator">|</span> Xor <span class="token operator">|</span> ori <span class="token operator">|</span> slt <span class="token operator">|</span> sltu <span class="token operator">|</span></pre></td></tr><tr><td data-num="6"></td><td><pre>                    sll <span class="token operator">|</span> sllv <span class="token operator">|</span> sra <span class="token operator">|</span> srav <span class="token operator">|</span> srl <span class="token operator">|</span> srlv <span class="token operator">|</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                    <span class="token punctuation">(</span><span class="token punctuation">(</span>opcode <span class="token operator">==</span> <span class="token number">6'b000000</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>funct<span class="token operator">==</span><span class="token number">6'b000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                    div <span class="token operator">|</span> divu <span class="token operator">|</span> mfhi <span class="token operator">|</span> mflo <span class="token operator">|</span> mthi <span class="token operator">|</span> mtlo <span class="token operator">|</span> mult <span class="token operator">|</span> multu <span class="token operator">|</span></pre></td></tr><tr><td data-num="9"></td><td><pre>                    mtc0 <span class="token operator">|</span> mfc0 <span class="token operator">|</span> eret<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>有些实现方式可能需要<strong>考虑 sll 和 nop 的问题</strong>，但是我貌似就不用，这里提醒一下</p><p>对于 ALU 的溢出检测，由于我们需要同时检测算术溢出和取值地址计算溢出，因此有两个，我们传入 ALU 的信号需要包括<strong>应当检测哪种类型的溢出</strong>，因此输入端口的定义如下，前两个输入就是检测什么溢出，后两个输出表示是否检测到异常：</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">module</span> <span class="token function">E_ALU</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">input</span> ALUDMOv<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">input</span> ALUAriOv<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> A<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> B<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">input</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ALUOp<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">output</span> <span class="token keyword">reg</span> <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> C<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">output</span> EXC_AriOv<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">output</span> EXC_DMOv</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>内部这样改，反正都差不多，直接放代码出来</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ext_A <span class="token operator">=</span> <span class="token operator">&#123;</span>A<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token operator">&#125;</span><span class="token punctuation">,</span> ext_B <span class="token operator">=</span> <span class="token operator">&#123;</span>B<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">,</span> B<span class="token operator">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ext_add <span class="token operator">=</span> ext_A <span class="token operator">+</span> ext_B<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">wire</span> <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span> ext_sub <span class="token operator">=</span> ext_A <span class="token operator">-</span> ext_B<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">assign</span> EXC_AriOv <span class="token operator">=</span> <span class="token punctuation">(</span>ALUAriOv<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> </pre></td></tr><tr><td data-num="5"></td><td><pre>                       <span class="token punctuation">(</span><span class="token punctuation">(</span>ALUOp <span class="token operator">==</span> <span class="token constant">`ALU_add</span> <span class="token operator">&amp;&amp;</span> ext_add<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">!=</span> ext_add<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="6"></td><td><pre>                       <span class="token punctuation">(</span>ALUOp <span class="token operator">==</span> <span class="token constant">`ALU_sub</span> <span class="token operator">&amp;&amp;</span> ext_sub<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">!=</span> ext_sub<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">assign</span> EXC_DMOv <span class="token operator">=</span> <span class="token punctuation">(</span>ALUDMOv<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>                       <span class="token punctuation">(</span><span class="token punctuation">(</span>ALUOp <span class="token operator">==</span> <span class="token constant">`ALU_add</span> <span class="token operator">&amp;&amp;</span> ext_add<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">!=</span> ext_add<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="9"></td><td><pre>                       <span class="token punctuation">(</span>ALUOp <span class="token operator">==</span> <span class="token constant">`ALU_sub</span> <span class="token operator">&amp;&amp;</span> ext_sub<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">!=</span> ext_sub<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>M 级的检测主要是条件很多，需要对照着逐一检测，下面分别给出 BE 和 DE 里面检测储存和读取的异常检测</p><p>这个是储存的</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">wire</span> ErrAlign <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>BEOp <span class="token operator">==</span> <span class="token constant">`BE_sw</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">|</span>Addr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="2"></td><td><pre>                    <span class="token punctuation">(</span><span class="token punctuation">(</span>BEOp <span class="token operator">==</span> <span class="token constant">`BE_sh</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">wire</span> ErrOutOfRange <span class="token operator">=</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token constant">`StartAddrDM</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr <span class="token operator">&lt;=</span> <span class="token constant">`EndAddrDM</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="5"></td><td><pre>                           <span class="token punctuation">(</span><span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token constant">`StartAddrTC1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr <span class="token operator">&lt;=</span> <span class="token constant">`EndAddrTC1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="6"></td><td><pre>                           <span class="token punctuation">(</span><span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token constant">`StartAddrTC2</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr <span class="token operator">&lt;=</span> <span class="token constant">`EndAddrTC2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">wire</span> ErrTimer <span class="token operator">=</span> <span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token number">32'h0000_7f08</span> <span class="token operator">&amp;&amp;</span> Addr <span class="token operator">&lt;=</span> <span class="token number">32'h0000_7f0b</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="9"></td><td><pre>                    <span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token number">32'h0000_7f18</span> <span class="token operator">&amp;&amp;</span> Addr <span class="token operator">&lt;=</span> <span class="token number">32'h0000_7f1b</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="10"></td><td><pre>                    <span class="token punctuation">(</span>BEOp <span class="token operator">!=</span> <span class="token constant">`BE_sw</span> <span class="token operator">&amp;&amp;</span> Addr <span class="token operator">>=</span> <span class="token constant">`StartAddrTC1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">assign</span> M_EXC_AdES <span class="token operator">=</span> <span class="token punctuation">(</span>store<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ErrAlign <span class="token operator">||</span> ErrOutOfRange <span class="token operator">||</span> ErrTimer <span class="token operator">||</span> M_EXC_DMOv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>这个是读取的</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">wire</span> ErrAlign <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>DEOp <span class="token operator">==</span> <span class="token constant">`DE_lw</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">|</span>Addr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="2"></td><td><pre>                    <span class="token punctuation">(</span><span class="token punctuation">(</span>DEOp <span class="token operator">==</span> <span class="token constant">`DE_lh</span> <span class="token operator">||</span> DEOp <span class="token operator">==</span> <span class="token constant">`DE_lhu</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">wire</span> ErrOutOfRange <span class="token operator">=</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token constant">`StartAddrDM</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr <span class="token operator">&lt;=</span> <span class="token constant">`EndAddrDM</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="5"></td><td><pre>                           <span class="token punctuation">(</span><span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token constant">`StartAddrTC1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr <span class="token operator">&lt;=</span> <span class="token constant">`EndAddrTC1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span></pre></td></tr><tr><td data-num="6"></td><td><pre>                           <span class="token punctuation">(</span><span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token constant">`StartAddrTC2</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr <span class="token operator">&lt;=</span> <span class="token constant">`EndAddrTC2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">wire</span> ErrTimer <span class="token operator">=</span> <span class="token punctuation">(</span>DEOp <span class="token operator">!=</span> <span class="token constant">`DE_lw</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>Addr <span class="token operator">>=</span> <span class="token constant">`StartAddrTC1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">assign</span> M_EXC_AdEL <span class="token operator">=</span> <span class="token punctuation">(</span>load<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>ErrAlign <span class="token operator">||</span> ErrOutOfRange <span class="token operator">||</span> ErrTimer <span class="token operator">||</span> M_EXC_DMOv<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p><s>宏自己定义去，我就不放了</s></p><p>现在我们就实现了下图中的检测功能</p><p><img data-src="https://s2.loli.net/2021/12/15/D7V5YKMNwZgeIfT.png" alt="image-20211215230130193"></p><p>下面我们需要实现的是图中红线的功能，即异常码随流水线传递，直至提交到 CP0，<strong>注意如果一条指令出现多个异常以先出现的为准</strong>，具体在下面代码可以看出</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// D 级    </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">assign</span> D_EXCCode <span class="token operator">=</span> tmp_D_EXCCode <span class="token operator">?</span> tmp_D_EXCCode <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>                   D_EXC_RI <span class="token operator">?</span> <span class="token constant">`EXC_RI</span> <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>                   <span class="token constant">`EXC_None</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// E 级</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">assign</span> E_EXCCode <span class="token operator">=</span> <span class="token punctuation">(</span>tmp_E_EXCCode<span class="token punctuation">)</span> <span class="token operator">?</span> tmp_E_EXCCode <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>                   <span class="token punctuation">(</span>E_EXC_AriOv<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">`EXC_Ov</span> <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                   <span class="token constant">`EXC_None</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// M 级</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">assign</span> M_EXCCode <span class="token operator">=</span> <span class="token punctuation">(</span>tmp_M_EXCCode<span class="token punctuation">)</span> <span class="token operator">?</span> tmp_M_EXCCode <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                   <span class="token punctuation">(</span>M_EXC_AdES<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">`EXC_AdES</span> <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                   <span class="token punctuation">(</span>M_EXC_AdEL<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">`EXC_AdEL</span> <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                   <span class="token constant">`EXC_None</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>注意对于处于延迟槽中的指令，我们的 EPC 需要在 CP0 中特殊处理，因此当前指令是否在延迟槽内，我们需要新开一个信号 isInDelaySlot 跟着一起流水，另外对于阻塞插入的 nop，PC 值和 isInDelaySlot 都不正确，因此我们需要在 DE 流水线寄存器中特殊处理，利用下面的代码即可解决问题</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">if</span><span class="token punctuation">(</span>flush <span class="token operator">||</span> reset <span class="token operator">||</span> Req <span class="token operator">||</span> Stall<span class="token punctuation">)</span> <span class="token keyword">begin</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    E_PC <span class="token operator">&lt;=</span> Stall <span class="token operator">?</span> D_PC <span class="token punctuation">:</span> <span class="token punctuation">(</span>Req <span class="token operator">?</span> <span class="token number">32'h0000_4180</span><span class="token punctuation">:</span> <span class="token number">32'd0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    E_Instr <span class="token operator">&lt;=</span> <span class="token number">32'd0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    E_rs_data <span class="token operator">&lt;=</span> <span class="token number">32'd0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    E_rt_data <span class="token operator">&lt;=</span> <span class="token number">32'd0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    E_ext32 <span class="token operator">&lt;=</span> <span class="token number">32'd0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    E_b_jump <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>    E_DelaySlot <span class="token operator">&lt;=</span> Stall <span class="token operator">?</span> D_DelaySlot <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    E_EXCCode <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>  </pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">end</span></pre></td></tr></table></figure><p>我们既然已经实现了异常的检测与传递，下面就是 P7 异常处理的核心 CP0 处理器，它负责接受前面传来的异常信号和外部传入的中断信号，然后综合分析决定是否响应这个异常</p><h3 id="cp0协处理器"><a class="anchor" href="#cp0协处理器">#</a> CP0 协处理器</h3><p><strong>介绍</strong></p><p>协处理器 0，包含 4 个 32 位寄存器，用于支持中断和异常。</p><p><strong>端口定义</strong></p><table><thead><tr><th>端口</th><th>输入 / 输出</th><th>位宽</th><th>描述</th></tr></thead><tbody><tr><td>A1</td><td>I</td><td>5</td><td>指定 4 个寄存器中的一个，将其存储的数据读出到 RD</td></tr><tr><td>A2</td><td>I</td><td>5</td><td>指定 4 个寄存器中的一个，作为写入的目标寄存器</td></tr><tr><td>Din</td><td>I</td><td>32</td><td>写入寄存器的数据信号</td></tr><tr><td>PC</td><td>I</td><td>32</td><td>目前传入的下一个 EPC 值</td></tr><tr><td>ExcCodeIn</td><td>I</td><td>5</td><td>目前传入的下一个 ExcCode 值</td></tr><tr><td>isInDelaySlot</td><td>I</td><td>32</td><td>目前传入的下一个 BD 值</td></tr><tr><td>HWInt</td><td>I</td><td>6</td><td>外部硬件中断信号</td></tr><tr><td>WE</td><td>I</td><td>1</td><td>写使能信号，高电平有效</td></tr><tr><td>EXLClr</td><td>I</td><td>1</td><td>传入 eret 指令时将 SR 的 EXL 位置 0 ，高电平有效</td></tr><tr><td>clk</td><td>I</td><td>1</td><td>时钟信号</td></tr><tr><td>reset</td><td>I</td><td>1</td><td>同步复位信号</td></tr><tr><td>Req</td><td>O</td><td>1</td><td>输出当前的中断请求</td></tr><tr><td>EPCOut</td><td>O</td><td>32</td><td>输出当前 EPC 寄存器中的值</td></tr><tr><td>Dout</td><td>O</td><td>32</td><td>输出 A 指定的寄存器中的数据</td></tr><tr><td>TestIntResponse</td><td>O</td><td>1</td><td>检测 CPU 是否对外部中断产生响应，从而决定是否去写 <code>0x0000_7f20</code></td></tr></tbody></table><p><strong>功能定义</strong></p><table><thead><tr><th>序号</th><th>功能名称</th><th>功能描述</th></tr></thead><tbody><tr><td>1</td><td>同步复位</td><td>当时钟上升沿到来且同步复位信号有效时，将所有寄存器的值设置为 0</td></tr><tr><td>2</td><td>读数据</td><td>读出 A1 地址对应寄存器中存储的数据到 RD；当 WE 有效时会将 WD 的值会实时反馈到对应的 RD，当 ERET 有效时会将 EXL 置 0，即内部转发。</td></tr><tr><td>3</td><td>写数据</td><td>当 WE 有效且时钟上升沿到来时，将 WD 的数据写入 A2 对应的寄存器中。</td></tr><tr><td>4</td><td>中断处理</td><td>根据各种传入信号和寄存器的值判断当前是否要进行中断，将结果输出到 IntReq。</td></tr></tbody></table><p>内部主要干两件事，<strong>处理异常中断</strong>和<strong>管理那四个寄存器</strong>（我们只需要实现其中 4 个就行，注意还有两个是只读的，写入应该忽略）</p><p><strong>请注意：不管教程和 PPT 写的是啥鬼玩意，那四个寄存器每一个寄存器请务必开满 32 位！！！</strong></p><p><strong>否则课上会 GG</strong></p><p>管理寄存器就跟乘除槽管理 HI 和 LO 一样，开四个寄存器，然后根据 mfc0 和 mtc0 这两条指令处理他们的值就好</p><p>处理异常时需要干下面几件事：</p><p>将<strong>异常码 ExcCode</strong>、<strong>是否处于延迟槽中的判断信号 isInDelaySlot</strong> 和 ** 当前 PC（如果取指地址异常则传递错误的 PC 值）** 一直跟着流水线到达 M 级直至提交至 CP0，由 CP0 综合判断分析是否响应该异常</p><p>如果需要响应该异常，则<strong> CP0 输出 Req 信号置为 1</strong>，<strong>此时 FD、DE、DM、MW 寄存器响应 Req 信号，清空 Instr，将 PC 值设为 0x4180</strong>，然后<strong>输入 F 级的 NPC 也被置为 0x4180，下一条指令从 0x4180 开始执行</strong></p><p>当<strong>外设和系统外部输入中断信号时，CP0 同样也会确认是否响应该中断，然后把 Req 置为 1，执行相同的操作。异常中断同时发生则中断优先！</strong></p><p>当<strong>系统外部输入中断信号时，CP0 还会输出一个 TestIntResponse 信号指示是否响应外部中断信号，如果响应则系统会相应去写 0x7f20 地址，从而时外部中断信号停止</strong>（2021 年新增！）</p><p>还有一件事是关于乘除槽的，如果有异常在乘除槽之前被检出，那么就不执行乘除法，简单来说就是开启乘除槽条件在 Start 为 1 的基础上还要加一个 Req 为 0，这一点看一卡代码就行</p><p>如果是 <code>eret</code> 指令，那么 <code>EXL</code> 需要置 0，表明当前处于用户态，并没有在处理异常（这时候可以响应别的异常了），对于 eret 指令，<strong>我们还需要修改 NPC，因为不管是跳到异常处理程序还是跳回去都需要改变 NPC 的值</strong>，具体的改变代码如下：</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">assign</span> NPC <span class="token operator">=</span> <span class="token punctuation">(</span>Req<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">32'h0000_4180</span> <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>             <span class="token punctuation">(</span>eret<span class="token punctuation">)</span> <span class="token operator">?</span> EPC <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>             <span class="token punctuation">(</span>NPCOp <span class="token operator">==</span> <span class="token constant">`NPC_pc4</span><span class="token punctuation">)</span> <span class="token operator">?</span> F_PC <span class="token operator">+</span> <span class="token number">4</span> <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>             <span class="token punctuation">(</span>NPCOp <span class="token operator">==</span> <span class="token constant">`NPC_jr_jalr</span><span class="token punctuation">)</span> <span class="token operator">?</span> rs <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>             <span class="token punctuation">(</span>NPCOp <span class="token operator">==</span> <span class="token constant">`NPC_b</span> <span class="token operator">&amp;&amp;</span> b_jump<span class="token punctuation">)</span> <span class="token operator">?</span> D_PC <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token operator">&lt;!--</span>swig￼<span class="token number">0</span><span class="token operator">--></span><span class="token punctuation">,</span> imm16<span class="token punctuation">,</span> <span class="token number">2'b00</span><span class="token operator">&#125;</span> <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>             <span class="token punctuation">(</span>NPCOp <span class="token operator">==</span> <span class="token constant">`NPC_j_jal</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">&#123;</span>D_PC<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">,</span> imm26<span class="token punctuation">,</span> <span class="token number">2'b00</span><span class="token operator">&#125;</span> <span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>             F_PC <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>对于新加的两条处理 CP0 寄存器的指令，我没加任何转发，只是做了阻塞</p><p>只需要在 stall_control 里面加一句话就行：</p><figure class="highlight verilog"><figcaption data-lang="verilog"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">wire</span> stall_eret <span class="token operator">=</span> <span class="token punctuation">(</span>D_eret<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>E_mtc0 <span class="token operator">&amp;&amp;</span> E_rd_addr <span class="token operator">==</span> <span class="token number">5'd14</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>M_mtc0 <span class="token operator">&amp;&amp;</span> M_rd_addr <span class="token operator">==</span> <span class="token number">5'd14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h3 id="bridge"><a class="anchor" href="#bridge">#</a> Bridge</h3><p>系统桥是处理 CPU 与外设（两个计时器）之间信息交互的通道</p><p>CPU 中 store 类指令需要储存的数据经过 BE 处理后会通过 m_data_addr, m_data_byteen, m_data_wdata 三个信号输出到桥中，桥会根据写使能 m_data_byteen 和地址 m_data_addr 来判断到底写的是内存还是外设，然后给出正确的写使能</p><p>load 类指令则是全部把地址传递给每个外设和 DM 中，然后桥根据地址选择从应该反馈给 CPU 从哪里读出来的数据，然后 DE 在处理读出的数据，反馈正确的结果</p><p>Bridge 的端口列表如下：</p><p><img data-src="https://s2.loli.net/2021/12/15/8zLPyR9vmTJN2q7.png" alt="image-20211214173339813"></p><p>这个很容易加的，直接根据地址选择是读内存还是外设，是传给 CPU 外设读出来的数据还是内存的数据</p><p>对于我的设计而言，CPU 仅仅与 Bridge 交互，输出地址、输出数据、输入的数据全部进入 Bridge 里面，然后 Bridge 会根据地址判断到底是往哪里写，又反馈给 CPU 什么数据</p><p><strong>不用担心越界的问题，这次的 DM 和 Timer 都是助教给的，他们已经考虑的很全面了</strong></p><h3 id="顶层mips微系统"><a class="anchor" href="#顶层mips微系统">#</a> 顶层 Mips 微系统</h3><p>最后 mips.v 中实例化 CPU，Bridge，TC0 和 TC1 三个模块相互交互</p><p>利用这样两句实现写 0x7f20，停止中断使能（<strong>2021 新增！</strong>）</p><p><img data-src="https://s2.loli.net/2021/12/15/2GW3RXyFs6heljq.png" alt="image-20211214180656444"></p><h2 id="课上测试说明"><a class="anchor" href="#课上测试说明">#</a> 课上测试说明</h2><p>就是强测一下，按照我上面提到的注意点，根本不会出现任何问题</p><p>加的那条指令描述如下：</p><p><code>tltiu $t0, imm16</code> ，如果 GPR [rs] &lt; imm16，那么会产生 Trap (EXCCode = 13) 的异常，imm16 符号扩展</p><p>解法如下</p><ul><li>加一下 Trap 异常，就是在 def.v 里面定义一下</li><li>决定在哪里处理异常，反正我是在 E 级，然后把它放进 calc_i 类指令里，自动转发阻塞支持</li><li>在 ALU 里面加一句判断，多连出来一个异常指示信号</li><li><strong>重点在这里：我们已经把它归入 calc_i 类，但是这条指令不应当写寄存器，因此在要写的寄存器编号那里需要特判一下，把这条指令要写的寄存器特判为 0</strong></li><li>然后就搞定了</li></ul><h2 id="思考题参考答案"><a class="anchor" href="#思考题参考答案">#</a> 思考题参考答案</h2><ol><li><p><strong>我们计组课程一本参考书目标题中有 “硬件 / 软件接口” 接口字样，那么到底什么是 “硬件 / 软件接口”？（Tips：什么是接口？和我们到现在为止所学的有什么联系？）</strong></p><p>“硬件 / 软件接口” 是指令（机器码）。硬件实现了一些功能，并按照规约可以被相应的指令所操控。软件通过规约使用相应的指令操控硬件完成相应的功能，从而达到软件所期望的效果。指令在这个过程中实现了硬件软件的对接，因此是 “硬件 / 软件接口”。</p></li><li><p><strong>BE 部件对所有的外设都是必要的吗？</strong></p><p>不是，只有对<strong>字节 / 半字</strong>有存取需求的才有必要。</p></li><li><p><strong>请阅读官方提供的定时器源代码，阐述两种中断模式的异同，并分别针对每一种模式绘制状态转移图。</strong></p><p>见计时器说明文档。</p></li><li><p><strong>请开发一个主程序以及定时器的 exception handler。整个系统完成如下功能：</strong></p><ol><li><p>定时器在主程序中被初始化为模式 0；</p></li><li><p>定时器倒计数至 0 产生中断；</p></li><li><p>handler 设置使能 Enable 为 1 从而再次启动定时器的计数器。2 及 3 被无限重复。</p></li><li><p>主程序在初始化时将定时器初始化为模式 0，设定初值寄存器的初值为某个值，如 100 或 1000。（注意，主程序可能需要涉及对 CP0.SR 的编程，推荐阅读过后文后再进行。）</p><pre><code class="language-assembly">.text
li $12, 0x0401
mtc0 $12, $12
li $1, 100
li $2, 9
sw $1, 0x7f04($0)
sw $2, 0x7f00($0)

dead_loop:
j dead_loop
nop

.ktext 0x4180
li $1, 100
li $2, 9
sw $1, 0x7f04($0)
sw $2, 0x7f00($0)
eret
</code></pre></li></ol></li><li><p><strong>请查阅相关资料，说明鼠标和键盘的输入信号是如何被 CPU 知晓的？</strong></p><p>鼠标和键盘产生中断信号，进入中断处理区的对应位置，将输入信号从鼠标和键盘中读入寄存器。</p></li></ol><div class="tags"><a href="/tags/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" rel="tag"><i class="ic i-tag"></i> 北航计算机组成原理</a> <a href="/tags/Verilog/" rel="tag"><i class="ic i-tag"></i> Verilog</a> <a href="/tags/MIPS/" rel="tag"><i class="ic i-tag"></i> MIPS</a> <a href="/tags/%E6%B5%81%E6%B0%B4%E7%BA%BFCPU/" rel="tag"><i class="ic i-tag"></i> 流水线CPU</a> <a href="/tags/P7%E8%AF%BE%E4%B8%8A/" rel="tag"><i class="ic i-tag"></i> P7课上</a> <a href="/tags/P7%E8%AF%BE%E4%B8%8B/" rel="tag"><i class="ic i-tag"></i> P7课下</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-12-15 23:15:35" itemprop="dateModified" datetime="2021-12-15T23:15:35+08:00">2021-12-15</time> </span><span id="2021/12/15/BUAA-CO-2021/P7/P7课上&课下/" class="item leancloud_visitors" data-flag-title="P7 课下 & 课上总结" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="FL 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="FL 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="FL 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>FL <i class="ic i-at"><em>@</em></i>FlyingLandlord's Blog</li><li class="link"><strong>本文链接：</strong> <a href="http://flyinglandlord.github.io/2021/12/15/BUAA-CO-2021/P7/P7%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" title="P7 课下 &amp; 课上总结">http://flyinglandlord.github.io/2021/12/15/BUAA-CO-2021/P7/P7课上&课下/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/12/08/BUAA-CO-2021/P6/P6%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;api.yimian.xyz&#x2F;img?type&#x3D;wallpaper&amp;size&#x3D;1920x1080?310056" title="P6课下&amp;课上总结"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 北航计算机组成原理</span><h3>P6课下&课上总结</h3></a></div><div class="item right"><a href="/2021/12/29/BUAA-CO-2021/P8/P8%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" itemprop="url" rel="next" data-background-image="&#x2F;assets&#x2F;Rikka.jpg" title="P8课下&amp;课上总结"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 北航计算机组成原理</span><h3>P8课下&课上总结</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#p7mips%E5%BE%AE%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.</span> <span class="toc-text">P7：MIPS 微系统设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BE%E4%B8%8B%E8%AE%BE%E8%AE%A1%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">课下设计概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cp0%E5%8D%8F%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">1.1.1.</span> <span class="toc-text">CP0 协处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bridge"><span class="toc-number">1.1.2.</span> <span class="toc-text">Bridge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B6%E5%B1%82mips%E5%BE%AE%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.3.</span> <span class="toc-text">顶层 Mips 微系统</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BE%E4%B8%8A%E6%B5%8B%E8%AF%95%E8%AF%B4%E6%98%8E"><span class="toc-number">1.2.</span> <span class="toc-text">课上测试说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%9D%E8%80%83%E9%A2%98%E5%8F%82%E8%80%83%E7%AD%94%E6%A1%88"><span class="toc-number">1.3.</span> <span class="toc-text">思考题参考答案</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2021/09/15/BUAA-CO-2021/Pre/Logisim%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/" rel="bookmark" title="Logisim斐波那契电路">Logisim斐波那契电路</a></li><li><a href="/2021/09/25/BUAA-CO-2021/Pre/%E5%85%B3%E4%BA%8ECPU%E8%BE%93%E5%87%BA%E5%BA%8F%E5%88%97%E6%A3%80%E6%9F%A5%E9%A2%98%E7%9A%84%E8%B0%83%E8%AF%95%E5%BB%BA%E8%AE%AE/" rel="bookmark" title="CPU输出序列检查调试方法">CPU输出序列检查调试方法</a></li><li><a href="/2021/09/25/BUAA-CO-2021/Pre/Verilog%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%BB%83%E4%B9%A0%E9%A2%98%E6%80%BB%E7%BB%93(Part1)/" rel="bookmark" title="Verilog 学习笔记（1）">Verilog 学习笔记（1）</a></li><li><a href="/2021/09/25/BUAA-CO-2021/Pre/Verilog%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%BB%83%E4%B9%A0%E9%A2%98%E6%80%BB%E7%BB%93(Part2)/" rel="bookmark" title="Verilog 学习笔记（2）">Verilog 学习笔记（2）</a></li><li><a href="/2021/09/30/BUAA-CO-2021/Pre/%E8%B0%88%E4%B8%80%E8%B0%88MIPS%E6%B1%87%E7%BC%96Challenge%E9%A2%98/" rel="bookmark" title="MIPS汇编哈密顿回路">MIPS汇编哈密顿回路</a></li><li><a href="/2021/10/13/BUAA-CO-2021/Pre/Logisim%E5%A4%8D%E4%B9%A0/" rel="bookmark" title="Logisim Pre考前复习">Logisim Pre考前复习</a></li><li><a href="/2021/10/13/BUAA-CO-2021/Pre/Verilog%E5%A4%8D%E4%B9%A0/" rel="bookmark" title="Verilog Pre考前复习">Verilog Pre考前复习</a></li><li><a href="/2021/10/13/BUAA-CO-2021/Pre/Pre%E8%AF%BE%E4%B8%8A%E6%B5%8B%E8%AF%95/" rel="bookmark" title="Pre课上测试游记">Pre课上测试游记</a></li><li><a href="/2021/10/20/BUAA-CO-2021/P0/P0%E8%AF%BE%E4%B8%8A%E6%B5%8B%E8%AF%95%E6%B8%B8%E8%AE%B0/" rel="bookmark" title="P0课上测试游记">P0课上测试游记</a></li><li><a href="/2021/10/24/BUAA-CO-2021/P1/P1%E8%AF%BE%E4%B8%8B%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="P1课下学习">P1课下学习</a></li><li><a href="/2021/10/27/BUAA-CO-2021/P1/P1%E8%AF%BE%E4%B8%8A%E6%B5%8B%E8%AF%95%E6%B8%B8%E8%AE%B0/" rel="bookmark" title="P1课上测试游记">P1课上测试游记</a></li><li><a href="/2021/11/01/BUAA-CO-2021/P2/P2%E8%AF%BE%E4%B8%8B%E5%AD%A6%E4%B9%A0/" rel="bookmark" title="P2课下学习">P2课下学习</a></li><li><a href="/2021/11/03/BUAA-CO-2021/P2/P2%E8%AF%BE%E4%B8%8A%E6%B5%8B%E8%AF%95%E6%B8%B8%E8%AE%B0/" rel="bookmark" title="P2课上测试游记">P2课上测试游记</a></li><li><a href="/2021/11/10/BUAA-CO-2021/P3/P3%E8%AF%BE%E4%B8%8A%E6%B5%8B%E8%AF%95%E6%B8%B8%E8%AE%B0/" rel="bookmark" title="P3课上测试游记">P3课上测试游记</a></li><li><a href="/2021/11/13/BUAA-CO-2021/P3/CPU%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/" rel="bookmark" title="P3课下学习—单周期CPU设计(1)">P3课下学习—单周期CPU设计(1)</a></li><li><a href="/2021/11/13/BUAA-CO-2021/P4/CPU%E8%AE%BE%E8%AE%A1%E6%96%87%E6%A1%A3/" rel="bookmark" title="P4课下学习—单周期CPU设计(2)">P4课下学习—单周期CPU设计(2)</a></li><li><a href="/2021/11/17/BUAA-CO-2021/P4/P4%E8%AF%BE%E4%B8%8A%E6%B5%8B%E8%AF%95%E6%B8%B8%E8%AE%B0/" rel="bookmark" title="P4课上测试">P4课上测试</a></li><li><a href="/2021/12/01/BUAA-CO-2021/P5/P5%E8%AF%BE%E4%B8%8B/" rel="bookmark" title="P5课下学习—流水线CPU设计(1)">P5课下学习—流水线CPU设计(1)</a></li><li><a href="/2021/12/02/BUAA-CO-2021/P5/P5%E8%AF%BE%E4%B8%8A1&2/" rel="bookmark" title="P5课上测试1&2">P5课上测试1&2</a></li><li><a href="/2021/12/08/BUAA-CO-2021/P6/P6%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" rel="bookmark" title="P6课下&课上总结">P6课下&课上总结</a></li><li class="active"><a href="/2021/12/15/BUAA-CO-2021/P7/P7%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" rel="bookmark" title="P7课下&课上总结">P7课下&课上总结</a></li><li><a href="/2021/12/29/BUAA-CO-2021/P8/P8%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" rel="bookmark" title="P8课下&课上总结">P8课下&课上总结</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="FL" data-src="/images/avatar.jpg"><p class="name" itemprop="name">FL</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">26</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">5</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">32</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZseWluZ2xhbmRsb3Jk" title="https:&#x2F;&#x2F;github.com&#x2F;flyinglandlord"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjI2NDUzNzcxNjFAcXEuY29t" title="mailto:2645377161@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/12/08/BUAA-CO-2021/P6/P6%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/12/29/BUAA-CO-2021/P8/P8%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 北航计算机组成原理">北航计算机组成原理</a></div><span><a href="/2021/09/15/BUAA-CO-2021/Pre/Logisim%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/" title="Logisim斐波那契电路">Logisim斐波那契电路</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 北航计算机组成原理">北航计算机组成原理</a></div><span><a href="/2021/09/25/BUAA-CO-2021/Pre/%E5%85%B3%E4%BA%8ECPU%E8%BE%93%E5%87%BA%E5%BA%8F%E5%88%97%E6%A3%80%E6%9F%A5%E9%A2%98%E7%9A%84%E8%B0%83%E8%AF%95%E5%BB%BA%E8%AE%AE/" title="CPU输出序列检查调试方法">CPU输出序列检查调试方法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="分类于 北航操作系统">北航操作系统</a></div><span><a href="/2022/04/29/BUAA-OS-2022/lab3/lab3-quiz/" title="BUAA-OS Lab3上机">BUAA-OS Lab3上机</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 北航计算机组成原理">北航计算机组成原理</a></div><span><a href="/2021/12/08/BUAA-CO-2021/P6/P6%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" title="P6课下&amp;课上总结">P6课下&课上总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 北航计算机组成原理">北航计算机组成原理</a></div><span><a href="/2021/12/02/BUAA-CO-2021/P5/P5%E8%AF%BE%E4%B8%8A1&2/" title="P5课上测试1&amp;2">P5课上测试1&2</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 北航计算机组成原理">北航计算机组成原理</a></div><span><a href="/2021/10/13/BUAA-CO-2021/Pre/Pre%E8%AF%BE%E4%B8%8A%E6%B5%8B%E8%AF%95/" title="Pre课上测试游记">Pre课上测试游记</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/" title="分类于 二进制杂谈">二进制杂谈</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/Theme-Shoka-Documentation/" title="分类于 Theme Shoka Documentation">Theme Shoka Documentation</a></div><span><a href="/2020/08/13/%E7%89%B9%E6%AE%8A%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/" title="主题特殊功能测试">主题特殊功能测试</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 北航计算机组成原理">北航计算机组成原理</a></div><span><a href="/2021/10/13/BUAA-CO-2021/Pre/Verilog%E5%A4%8D%E4%B9%A0/" title="Verilog Pre考前复习">Verilog Pre考前复习</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 北航计算机组成原理">北航计算机组成原理</a></div><span><a href="/2021/12/29/BUAA-CO-2021/P8/P8%E8%AF%BE%E4%B8%8A&%E8%AF%BE%E4%B8%8B/" title="P8课下&amp;课上总结">P8课下&课上总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%8C%97%E8%88%AA%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 北航计算机组成原理">北航计算机组成原理</a></div><span><a href="/2021/11/01/BUAA-CO-2021/P2/P2%E8%AF%BE%E4%B8%8B%E5%AD%A6%E4%B9%A0/" title="P2课下学习">P2课下学习</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">FL @ Test Blog</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/12/15/BUAA-CO-2021/P7/P7课上&课下/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>